<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>para mi novia preciosa â¤ï¸</title>
  <style>
    :root{
      --bg:#0f0f14; --card:#171722; --muted:#9aa0a6; --accent:#ff6fa9; --accent-2:#a78bfa; --text:#f7f7fb;
    }
    *{box-sizing:border-box}
    html,bodyhtml,body{
    margin:0;
    padding:0;
    background: radial-gradient(circle at 75% -5%, #18122B 0%, #0c0816 60%, #060408 100%);
    color:var(--text);
    font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji"
}
    a{color:inherit}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{position:relative;overflow:hidden;border-bottom:1px solid rgba(255,255,255,.06)}
    .hero{display:grid;grid-template-columns:1.1fr .9fr;gap:26px;align-items:center;padding:56px 24px}
    @media (max-width:900px){.hero{grid-template-columns:1fr;padding:36px 16px}}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));backdrop-filter: blur(6px);border:1px solid rgba(255,255,255,.08);border-radius:20px;box-shadow:0 10px 40px rgba(0,0,0,.35)}
    .title{font-size:clamp(28px,4.2vw,44px);font-weight:800;letter-spacing:.4px;margin:0 0 10px}
    .subtitle{color:var(--muted);margin:0}
    .pill{display:inline-flex;gap:8px;align-items:center;padding:8px 12px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.09);font-weight:600;font-size:14px}
    .btn{appearance:none;border:none;border-radius:14px;padding:12px 16px;font-weight:700;cursor:pointer;background:linear-gradient(135deg,var(--accent),#ff94c4);color:#1a0820;box-shadow:0 10px 20px rgba(255,111,169,.35);transition:transform .08s ease, box-shadow .2s}
    .btn:active{transform:translateY(1px);box-shadow:0 6px 12px rgba(255,111,169,.25)}
    .btn.outline{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.14)}

    /* floating hearts bg */
    .float-heart{position:absolute;top:-20px;animation: fall 9s linear infinite;opacity:.7;filter: drop-shadow(0 4px 10px rgba(255,111,169,.3))}
    @keyframes fall{to{transform:translateY(130vh) rotate(360deg)}}

    section{padding:36px 0}
    h2{font-size:clamp(22px,3.2vw,30px);margin:0 0 18px}

    /* Gallery */
    .gallery{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
    @media (max-width:1000px){.gallery{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:720px){.gallery{grid-template-columns:repeat(2,1fr)}}
    .gallery figure{margin:0;position:relative;border-radius:14px;overflow:hidden;cursor:zoom-in;background:var(--card);border:1px solid rgba(255,255,255,.06)}
    .gallery img{width:100%;height:180px;object-fit:cover;display:block;transition:transform .35s ease}
    .gallery figure:hover img{transform:scale(1.04)}

    /* Lightbox */
    .lightbox{position:fixed;inset:0;background:rgba(7,7,10,.84);backdrop-filter: blur(6px);display:none;place-items:center;z-index:50}
    .lightbox.open{display:grid}
    .lightbox img{max-width:min(92vw,1100px);max-height:82vh;border-radius:16px;border:1px solid rgba(255,255,255,.12);background:#000}
    .lb-controls{position:fixed;inset:0;display:flex;align-items:center;justify-content:space-between;padding:0 24px}
    .lb-btn{background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.22);backdrop-filter: blur(6px);width:44px;height:44px;border-radius:50%;display:grid;place-items:center;cursor:pointer;font-size:22px;font-weight:900}
    .lb-close{position:fixed;top:18px;right:18px}

    /* Game */
    .game-wrap{display:grid;grid-template-columns:1.1fr .9fr;gap:20px}
    @media (max-width:1000px){.game-wrap{grid-template-columns:1fr;}}
    canvas{width:100%;height:auto;background:linear-gradient(180deg,#141824,#0e1118);border-radius:20px;border:1px solid rgba(255,255,255,.08)}
    .hud{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .badge{padding:8px 12px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);font-weight:700}
    .tip{font-size:14px;color:var(--muted)}
    .overlay{position:absolute;inset:0;display:none;place-items:center;text-align:center;padding:20px}
    .overlay.show{display:grid}
    .overlay .box{background:rgba(10,10,14,.8);border:1px solid rgba(255,255,255,.12);padding:24px;border-radius:18px}

    footer{padding:28px 0 48px;color:var(--muted);text-align:center}
  </style>
</head>
<body>
  <header>
    <!-- floating hearts (decoraciÃ³n) -->
    <svg class="float-heart" style="left:6%; animation-delay: .2s; width:22px;" viewBox="0 0 24 24"><path fill="currentColor" d="M12 21s-6.716-4.516-9.6-7.4C.515 11.715.515 8.286 2.4 6.4c1.885-1.885 4.943-1.885 6.828 0L12 9.172l2.772-2.772c1.885-1.885 4.943-1.885 6.828 0 1.885 1.886 1.885 5.315 0 7.2C18.716 16.484 12 21 12 21Z"/></svg>
    <svg class="float-heart" style="left:22%; animation-delay: 1.2s; width:16px;" viewBox="0 0 24 24"><path fill="currentColor" d="M12 21s-6.716-4.516-9.6-7.4C.515 11.715.515 8.286 2.4 6.4c1.885-1.885 4.943-1.885 6.828 0L12 9.172l2.772-2.772c1.885-1.885 4.943-1.885 6.828 0 1.885 1.886 1.885 5.315 0 7.2C18.716 16.484 12 21 12 21Z"/></svg>
    <svg class="float-heart" style="left:64%; animation-delay: .8s; width:18px;" viewBox="0 0 24 24"><path fill="currentColor" d="M12 21s-6.716-4.516-9.6-7.4C.515 11.715.515 8.286 2.4 6.4c1.885-1.885 4.943-1.885 6.828 0L12 9.172l2.772-2.772c1.885-1.885 4.943-1.885 6.828 0 1.885 1.886 1.885 5.315 0 7.2C18.716 16.484 12 21 12 21Z"/></svg>
    <svg class="float-heart" style="left:85%; animation-delay: 2.2s; width:20px;" viewBox="0 0 24 24"><path fill="currentColor" d="M12 21s-6.716-4.516-9.6-7.4C.515 11.715.515 8.286 2.4 6.4c1.885-1.885 4.943-1.885 6.828 0L12 9.172l2.772-2.772c1.885-1.885 4.943-1.885 6.828 0 1.885 1.886 1.885 5.315 0 7.2C18.716 16.484 12 21 12 21Z"/></svg>

    <div class="container hero">
      <div class="card" style="padding:22px 22px 26px">
        <div class="pill">Para: <span id="nameTarget">anny mi mujer </span>â¤ï¸</div>
        <h1 class="title">Nosotro :3</h1>
        <p class="subtitle">Fotito juntos en roblo y un jueguito solo pa ti mi amor â¤ï¸</p>
        <div style="display:flex; gap:10px; margin-top:16px; flex-wrap:wrap">
          <button class="btn" id="scrollToGallery">Ver Ã¡lbum</button>
          <button class="btn outline" id="scrollToGame">Jugar</button>
        </div>
      </div>
      <div class="card" style="padding:22px">
        <h3 style="margin:0 0 12px">Mensajito secreto :O</h3>
        <p id="loveMessage" style="margin:0;color:#e9e4ff">Eres la chica mas dulce que he conocido, endulzas mi vida cada dia y me haces muy feli, gracias por estar conmigo te amo mushooooo mi amol</p>
        <div style="display:flex; gap:10px; margin-top:16px; align-items:center; flex-wrap:wrap">
          <label class="tip"></label>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Ãlbum -->
    <section>
  <h2>roblo ğŸ®</h2>
  <div class="gallery">
    <figure><img src="images/roblo1.jpg" alt="Roblox"></figure>
    <figure><img src="images/roblo2.jpg" alt="Roblox"></figure>
    <figure><img src="images/roblo3.jpg" alt="Roblox"></figure>
    <figure><img src="images/roblo4.jpg" alt="Roblox"></figure>
    <figure><img src="images/roblo5.jpg" alt="Roblox"></figure>
    <figure><img src="images/roblo6.jpg" alt="Roblox"></figure>
    <figure><img src="images/roblo7.jpg" alt="Roblox"></figure>
  </div>
</section>

<section>
  <h2>Mi diosa ğŸ›</h2>
  <div class="gallery">
    <figure><img src="images/ella1.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella2.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella3.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella4.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella5.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella6.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella7.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella8.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella9.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella10.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella11.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella12.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella13.jpg" alt="Mi diosa"></figure>
    <figure><img src="images/ella14.jpg" alt="Mi diosa"></figure>

  </div>
</section>

<section>
  <h2>eia y io ğŸ’‘ğŸ»</h2>
  <div class="gallery">
    <figure><img src="images/nosotro1.jpg" alt="Momentos"></figure>
    <figure><img src="images/nosotro2.jpg" alt="Momentos"></figure>
    <figure><img src="images/nosotro3.jpg" alt="Momentos"></figure>
    <figure><img src="images/nosotro4.jpg" alt="Momentos"></figure>
    <figure><img src="images/nosotro5.jpg" alt="Momentos"></figure>
  </div>
</section>

<section>
  <h2>Nuestra hija ğŸˆ</h2>
  <div class="gallery">
    <figure><img src="images/hija1.jpg" alt="Momentos"></figure>
    <figure><img src="images/hija2.jpg" alt="Momentos"></figure>
  </div>
</section>
      

    <!-- Minijuego -->
    <section id="game">
      <h2>Jueguito: atrapa mi corazon JDSJJSJ pero ojito con lo corazone roto ğŸ™€</h2>
      <div class="game-wrap">
        <div style="position:relative">
          <canvas id="gameCanvas" width="900" height="520"></canvas>
          <div class="overlay" id="gameOverlay">
            <div class="box">
              <h3 id="overlayTitle" style="margin:0 0 8px">Listo para jugar</h3>
              <p id="overlayText" class="tip" style="margin:0 0 14px">Mueve el mouse (o tu dedo) para atrapar corazones. Evita los rotos ğŸ’”.</p>
              <div style="display:flex; gap:10px; justify-content:center; margin-top:4px">
                <button class="btn" id="startBtn">Empezar</button>
                <button class="btn outline" id="restartBtn" style="display:none">Volver a jugar</button>
              </div>
            </div>
          </div>
        </div>
        <div>
          <div class="card" style="padding:18px">
            <div class="hud">
              <div class="badge">Puntaje: <span id="score">0</span></div>
              <div class="badge">Vidas: <span id="lives">3</span></div>
              <div class="badge">Mejor: <span id="best">0</span></div>
            </div>
            <p class="tip" style="margin:14px 0 0">Ganas <b>1</b> puntito por cada corazÃ³n â¤ï¸ atrapado. Pierdes una vida si dejas caer un corazÃ³n o si atrapas un ğŸ’” roto. 
            Si llegas a <b id="goal">40</b> puntos, se desbloquea un mensajito especial mi amorcito âœ¨.</p>
            <div style="margin-top:14px;display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn" id="playBtn">Jugar ahora</button>
              <button class="btn outline" id="pauseBtn">Pausar</button>
            </div>
          </div>
         <div class="card" style="padding:18px; margin-top:12px; display:none;" id="surpriseMessageContainer">
  <h3 style="margin:0 0 8px">Mensaje sorpresa</h3>
  <p id="winMessage" class="tip" style="margin:0"></p>
  <small class="tip"></small>
</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    Hecho con amor por <span id="fromName">tu player 2</span>â¤ï¸
  </footer>

  <!-- Lightbox modal -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="lb-controls">
      <button class="lb-btn" id="prevBtn" aria-label="Anterior">â€¹</button>
      <button class="lb-btn" id="nextBtn" aria-label="Siguiente">â€º</button>
    </div>
    <button class="lb-btn lb-close" id="closeBtn" aria-label="Cerrar">âœ•</button>
    <img id="lbImage" alt="Foto" />
  </div>

  <script>
   
    const SETTINGS = {
      yourName: "cris",
      partnerName: "Anny mi mujer",
      targetScore: 40, // puntos para mostrar mensaje sorpresa
      loveMessage: "Eres la chica mas dulce que he conocido, endulzas mi vida cada dia y me haces muy feli, gracias por estar conmigo te amo mushooooo mi amol",
      winMessage: "Ganasteeeee que pro mi amor, ganaste aqui y te ganaste tambien mi corazon muaaaaa ğŸ˜½â¤ï¸",
    };

    
    

function showLightbox() {
  const lightbox = document.getElementById('lightbox');
  const lightboxImage = document.getElementById('lightbox-image');

  lightboxImage.src = photos[currentIndex];
  lightbox.style.display = 'flex';
}

function closeLightbox() {
  document.getElementById('lightbox').style.display = 'none';
}

function prevPhoto() {
  currentIndex = (currentIndex - 1 + photos.length) % photos.length;
  showLightbox();
}

function nextPhoto() {
  currentIndex = (currentIndex + 1) % photos.length;
  showLightbox();
}

    // Pega tus fotos de ROBLOX: reemplaza el arreglo por rutas locales, por ejemplo:
    // const photos = ["images/roblox1.jpg","images/roblox2.jpg", ...];

    // Escribe sus nombres y mensajes en la UI
    document.getElementById('nameTarget').textContent = SETTINGS.partnerName;
    document.getElementById('fromName').textContent = SETTINGS.yourName;
    document.getElementById('loveMessage').textContent = SETTINGS.loveMessage;
    document.getElementById('winMessage').textContent = SETTINGS.winMessage;
    document.getElementById('goal').textContent = SETTINGS.targetScore;

    // Scroll helpers
    document.getElementById('scrollToGallery').addEventListener('click',()=>document.getElementById('album').scrollIntoView({behavior:'smooth'}));
    document.getElementById('scrollToGame').addEventListener('click',()=>document.getElementById('game').scrollIntoView({behavior:'smooth'}));

    // ============================
 // ============================
Â  Â  // ğŸ“¸ GalerÃ­a + Lightbox
Â  Â  // ============================
Â  Â  // Tomar todas las imÃ¡genes que ya estÃ¡n en el HTML
const photos = Array.from(document.querySelectorAll('.gallery img')).map(img => img.src);

// Define las variables del lightbox aquÃ­, antes de usarlas.
const lb = document.getElementById('lightbox');
const lbImg = document.getElementById('lbImage');
const closeBtn = document.getElementById('closeBtn');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
let currentIndex; // Esta variable almacena el Ã­ndice de la imagen actual.

// Asignarles el evento para abrir el lightbox
document.querySelectorAll('.gallery img').forEach((img, i) => {
Â  img.addEventListener('click', () => openLightbox(i));
});

function openLightbox(i) {
Â  currentIndex = i;
Â  lbImg.src = photos[i];
Â  lb.classList.add('open');
Â  lb.setAttribute('aria-hidden', 'false');
}

function closeLightbox() {
Â  lb.classList.remove('open');
Â  lb.setAttribute('aria-hidden', 'true');
}

function showPrev() {
Â  currentIndex = (currentIndex - 1 + photos.length) % photos.length;
Â  lbImg.src = photos[currentIndex];
}

function showNext() {
Â  currentIndex = (currentIndex + 1) % photos.length;
Â  lbImg.src = photos[currentIndex];
}

lb.addEventListener('click', (e) => {
Â  if (e.target === lb) closeLightbox();
});
closeBtn.addEventListener('click', closeLightbox);
prevBtn.addEventListener('click', (e) => {
Â  e.stopPropagation();
Â  showPrev();
});
nextBtn.addEventListener('click', (e) => {
Â  e.stopPropagation();
Â  showNext();
});
window.addEventListener('keydown', (e) => {
Â  if (!lb.classList.contains('open')) return;
Â  if (e.key === 'Escape') closeLightbox();
Â  if (e.key === 'ArrowLeft') showPrev();
Â  if (e.key === 'ArrowRight') showNext();
});

// Nota: No necesitas llamar a renderGallery(); porque ya tienes las imÃ¡genes en el HTML.


   // ============================
Â  Â  // ğŸ® Minijuego: Atrapa corazones
Â  Â  // ============================
Â  Â  const canvas = document.getElementById('gameCanvas');
Â  Â  const ctx = canvas.getContext('2d');
Â  Â  const overlay = document.getElementById('gameOverlay');
Â  Â  const startBtn = document.getElementById('startBtn');
Â  Â  const restartBtn = document.getElementById('restartBtn');
Â  Â  const playBtn = document.getElementById('playBtn');
Â  Â  const pauseBtn = document.getElementById('pauseBtn');

Â  Â  const scoreEl = document.getElementById('score');
Â  Â  const livesEl = document.getElementById('lives');
Â  Â  const bestEl = document.getElementById('best');
Â  Â  const winMessageEl = document.getElementById('winMessage');
Â  Â  const surpriseMessageContainer = document.getElementById('surpriseMessageContainer');

Â  Â  let DPR = Math.max(1, window.devicePixelRatio || 1);
Â  Â  function resizeCanvas(){
Â  Â  Â  const rect = canvas.getBoundingClientRect();
Â  Â  Â  canvas.width = Math.floor(rect.width * DPR);
Â  Â  Â  canvas.height = Math.floor(rect.width * 0.58 * DPR); // 16:9-ish
Â  Â  }
Â  Â  resizeCanvas();
Â  Â  window.addEventListener('resize', resizeCanvas);

Â  Â  const state = {
Â  Â  Â  playing:false,
Â  Â  Â  paused:false,
Â  Â  Â  score:0,
Â  Â  Â  lives:3,
Â  Â  Â  best: Number(localStorage.getItem('bestHeartScore')||0),
Â  Â  Â  basketX: 0,
Â  Â  Â  basketY: 0,
Â  Â  Â  hearts: [],
Â  Â  Â  lastSpawn: 0,
Â  Â  Â  spawnEvery: 650, // ms
Â  Â  };
Â  Â  bestEl.textContent = state.best;

Â  Â  function resetGame(){
Â  Â  Â  state.playing = false; state.paused=false; state.score = 0; state.lives = 3; state.hearts = []; state.lastSpawn = 0;
Â  Â  Â  updateHUD();
Â  Â  Â  showOverlay(true, 'Listo para jugar', 'Mueve el mouse (o tu dedo) para atrapar corazones. Evita los rotos ğŸ’”.');
Â  Â  Â  restartBtn.style.display = 'none';
Â  Â  }

Â  Â  function updateHUD(){ scoreEl.textContent = state.score; livesEl.textContent = state.lives; }

Â  Â  function showOverlay(show, title, text){
Â  Â  Â  document.getElementById('overlayTitle').textContent = title;
Â  Â  Â  document.getElementById('overlayText').textContent = text;
Â  Â  Â  overlay.classList.toggle('show', !!show);
Â  Â  }

Â  Â  function startGame(){
Â  Â  Â  overlay.classList.remove('show');
Â  Â  Â  state.playing = true; state.paused=false; state.score=0; state.lives=3; state.hearts=[]; state.lastSpawn = 0; updateHUD();
Â  Â  Â  lastTime = performance.now();
Â  Â  Â  requestAnimationFrame(loop);
Â  Â  }

Â  Â  function pauseGame(){ state.paused = !state.paused; pauseBtn.textContent = state.paused ? 'Reanudar' : 'Pausar'; if(!state.paused && state.playing) { lastTime = performance.now(); requestAnimationFrame(loop);} }

Â  Â  // Input: mouse / touch
Â  Â  function setBasketFromEvent(x){
Â  Â  Â  const rect = canvas.getBoundingClientRect();
Â  Â  Â  const cx = (x - rect.left) * DPR;
Â  Â  Â  state.basketX = Math.max(0, Math.min(canvas.width, cx));
Â  Â  Â  state.basketY = canvas.height - 40 * DPR;
Â  Â  }
Â  Â  canvas.addEventListener('mousemove', e=> setBasketFromEvent(e.clientX));
Â  Â  canvas.addEventListener('touchmove', e=> { setBasketFromEvent(e.touches[0].clientX); e.preventDefault(); }, {passive:false});

Â  Â  // Helpers para dibujar
Â  Â  function heartPath(context, x, y, s){
Â  Â  Â  const cp = s * 0.55191502449; // circle control point
Â  Â  Â  context.beginPath();
Â  Â  Â  context.moveTo(x, y + s/4);
Â  Â  Â  context.bezierCurveTo(x, y, x - s/2, y, x - s/2, y + s/4);
Â  Â  Â  context.bezierCurveTo(x - s/2, y + s/1.5, x, y + s/1.2, x, y + s);
Â  Â  Â  context.bezierCurveTo(x, y + s/1.2, x + s/2, y + s/1.5, x + s/2, y + s/4);
Â  Â  Â  context.bezierCurveTo(x + s/2, y, x, y, x, y + s/4);
Â  Â  Â  context.closePath();
Â  Â  }

Â  Â  function drawHeart(x,y,size,broken=false){
Â  Â  Â  ctx.save();
Â  Â  Â  ctx.translate(x,y);
Â  Â  Â  ctx.fillStyle = broken ? '#ff335c' : '#ff77aa';
Â  Â  Â  heartPath(ctx,0,0,size);
Â  Â  Â  ctx.fill();
Â  Â  Â  if(broken){
Â  Â  Â  Â  // grieta
Â  Â  Â  Â  ctx.strokeStyle = '#2a0a14';
Â  Â  Â  Â  ctx.lineWidth = Math.max(1, size*0.06);
Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  ctx.moveTo(-size*0.05, size*0.2);
Â  Â  Â  Â  ctx.lineTo(0, size*0.45);
Â  Â  Â  Â  ctx.lineTo(size*0.1, size*0.7);
Â  Â  Â  Â  ctx.stroke();
Â  Â  Â  }
Â  Â  Â  ctx.restore();
Â  Â  }

Â  Â  function drawBasket(){
Â  Â  Â  const w = 120 * DPR, h = 20 * DPR;
Â  Â  Â  const x = Math.max(w/2, Math.min(canvas.width - w/2, state.basketX));
Â  Â  Â  const y = state.basketY;
Â  Â  Â  // barra redondeada
Â  Â  Â  ctx.save();
Â  Â  Â  ctx.fillStyle = '#ffe1f0';
Â  Â  Â  ctx.strokeStyle = '#ff99c7';
Â  Â  Â  roundRect(ctx, x - w/2, y - h/2, w, h, 10 * DPR);
Â  Â  Â  ctx.fill();
Â  Â  Â  ctx.stroke();
Â  Â  Â  ctx.restore();
Â  Â  Â  return {x: x - w/2, y: y - h/2, w, h};
Â  Â  }

Â  Â  function roundRect(ctx, x,y,w,h,r){
Â  Â  Â  ctx.beginPath();
Â  Â  Â  ctx.moveTo(x+r,y);
Â  Â  Â  ctx.arcTo(x+w,y,x+w,y+h,r);
Â  Â  Â  ctx.arcTo(x+w,y+h,x,y+h,r);
Â  Â  Â  ctx.arcTo(x,y+h,x,y,r);
Â  Â  Â  ctx.arcTo(x,y,x+w,y,r);
Â  Â  Â  ctx.closePath();
Â  Â  }

Â  Â  function spawnHeart(){
Â  Â  Â  const size = (18 + Math.random()*16) * DPR;
Â  Â  Â  const x = (20 + Math.random()*(canvas.width - 40));
Â  Â  Â  const speed = (1.1 + Math.random()*1.6) * DPR;
Â  Â  Â  const broken = Math.random() < 0.18; // 18% rotos
Â  Â  Â  state.hearts.push({x, y:-size, size, speed, broken});
Â  Â  }

Â  Â  function update(dt){
Â  Â  Â  state.lastSpawn += dt;
Â  Â  Â  if(state.lastSpawn > state.spawnEvery){
Â  Â  Â  Â  state.lastSpawn = 0; spawnHeart();
Â  Â  Â  }
Â  Â  Â  state.hearts.forEach(h => h.y += h.speed * dt/16.6);
Â  Â  Â  // colisiones
Â  Â  Â  const basket = drawBasket();
Â  Â  Â  for(let i = state.hearts.length-1; i>=0; i--){
Â  Â  Â  Â  const h = state.hearts[i];
Â  Â  Â  Â  const caught = h.y + h.size >= basket.y && h.y <= basket.y + basket.h && h.x >= basket.x && h.x <= basket.x + basket.w;
Â  Â  Â  Â  const hitGround = h.y > canvas.height + 10 * DPR;
Â  Â  Â  Â  if(caught){
Â  Â  Â  Â  Â  if(h.broken){ loseLife(); } else { state.score++; updateHUD(); }
Â  Â  Â  Â  Â  state.hearts.splice(i,1);
Â  Â  Â  Â  Â  checkWin();
Â  Â  Â  Â  } else if(hitGround){
Â  Â  Â  Â  Â  if(!h.broken){ loseLife(); }
Â  Â  Â  Â  Â  state.hearts.splice(i,1);
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }

Â  Â  function checkWin(){
Â  Â  Â  if(state.score >= SETTINGS.targetScore){
Â  Â  Â  Â  state.playing = false;
Â  Â  Â  Â  finish(true, SETTINGS.winMessage);
Â  Â  Â  }
Â  Â  }

Â  Â  function loseLife(){
Â  Â  Â  state.lives--; updateHUD();
Â  Â  Â  if(state.lives <= 0){ finish(false, 'peldiste amor sigue intentando'); }
Â  Â  }

Â  Â  let lastTime = 0;
Â  Â  function loop(ts){
Â  Â  Â  if(!state.playing || state.paused) return;
Â  Â  Â  const dt = Math.min(50, ts - lastTime); lastTime = ts;
Â  Â  Â  // clear
Â  Â  Â  ctx.clearRect(0,0,canvas.width,canvas.height);
Â  Â  Â  // fondo sutil
Â  Â  Â  const grd = ctx.createLinearGradient(0,0,0,canvas.height);
Â  Â  Â  grd.addColorStop(0,'#141824'); grd.addColorStop(1,'#0e1118');
Â  Â  Â  ctx.fillStyle = grd; ctx.fillRect(0,0,canvas.width,canvas.height);

Â  Â  Â  // guÃ­as (suaves)
Â  Â  Â  ctx.globalAlpha = .08;
Â  Â  Â  ctx.fillStyle = '#ffffff';
Â  Â  Â  for(let i=0;i<10;i++){ ctx.fillRect((i/10)*canvas.width, 0, 1, canvas.height); }
Â  Â  Â  ctx.globalAlpha = 1;

Â  Â  Â  // dibuja corazones
Â  Â  Â  state.hearts.forEach(h => drawHeart(h.x, h.y, h.size, h.broken));
Â  Â  Â  // dibuja canasta y actualiza
Â  Â  Â  update(dt);

Â  Â  Â  requestAnimationFrame(loop);
Â  Â  }

Â  Â  function finish(won, msg){
Â  Â  Â  state.playing = false; state.paused=false; pauseBtn.textContent = 'Pausar';
Â  Â  Â  state.best = Math.max(state.best, state.score); localStorage.setItem('bestHeartScore', state.best); bestEl.textContent = state.best;
Â  Â  Â  showOverlay(true, won ? 'Â¡Lo lograste! ğŸ™€ âœ¨' : 'Â¡Buen intento! ğŸ˜', msg + ` (Puntaje: ${state.score})`);
Â  Â  Â  restartBtn.style.display = 'inline-block';
Â  Â  Â  if (won) {
Â  Â  Â  Â  surpriseMessageContainer.style.display = 'block';
Â  Â  Â  Â  winMessageEl.textContent = SETTINGS.winMessage;
Â  Â  Â  }
Â  Â  }

Â  Â  startBtn.addEventListener('click', startGame);
Â  Â  restartBtn.addEventListener('click', startGame);
Â  Â  playBtn.addEventListener('click', ()=>{ if(!state.playing){ startGame(); } });
Â  Â  pauseBtn.addEventListener('click', ()=>{ if(state.playing){ pauseGame(); }});

Â  Â  // inicia centrando la canasta
Â  Â  setBasketFromEvent(canvas.getBoundingClientRect().left + canvas.getBoundingClientRect().width/2);
  </script>
</body>
</html>
